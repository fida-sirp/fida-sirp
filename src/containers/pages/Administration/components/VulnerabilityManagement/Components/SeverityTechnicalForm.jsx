import React, { useEffect, useState } from 'react';
import * as Yup from 'yup';
import { Formik, Form, Field } from 'formik';
import { Row, Col } from 'antd';
import SPButton from '../../../../../../components/SPButton';
import 'antd/dist/antd.css';
import InputBox from '../../../../../../components/InputBox';

function NonTechnicalFormDrawer({
    isOpen,
    submit,
    record,
    closeDrawer,
    isCreate
}) {
    const formInitialValues = {
        name: record?.name || '',
        order: record?.order || '',
        color: record?.color || ""
    }
    let validationSchemaStandard = Yup.object({
        name: Yup.string().required("This Field is Required"),
        order: Yup.number().max(6, 'Order must be no greater than 6.')
    });

    return (
        <div>
            <Formik
                id="formik"
                validationSchema={validationSchemaStandard}
                initialValues={formInitialValues}
                enableReinitialize
                onSubmit={(values, { resetForm }) => {
                    submit(values);
                    resetForm();
                }}
            >
                {({
                    values,
                    errors,
                    touched,
                    handleChange,
                    handleBlur,
                    handleSubmit,
                    isSubmitting,
                    resetForm,
                    setFieldValue,
                }) => {
                    useEffect(() => {
                        resetForm()
                    }, [isOpen])
                    return (
                        <Form>
                            <InputBox
                                id={'name'}
                                label={'Name'}
                                name={'name'}
                                placeholder={'Name'}
                                onInputChange={handleChange}
                                onBlur={handleBlur}
                                value={values.name}
                                touched={touched.name}
                                noBorderValidation
                                isHide={!isCreate}
                            />
                            <InputBox
                                id="order"
                                label="Order"
                                name="order"
                                type="number"
                                placeholder="Order"
                                onInputChange={handleChange}
                                onBlur={handleBlur}
                                errorMessage={errors.order}
                                value={values.order}
                                touched={touched.order}
                            />

                            <Row>
                                <Col span={18}>
                                    <InputBox
                                        id="color"
                                        label="color"
                                        name="color"
                                        placeholder="color"
                                        onInputChange={handleChange}
                                        onBlur={handleBlur}
                                        errorMessage={errors.color}
                                        value={values.color}
                                        touched={touched.color}
                                    />
                                </Col>
                                <Col span={6} style={{ display: "flex", alignItems: "center", justifyItems: "flex-end", justifyContent: "center", paddingTop: 10 }}>
                                    <Field type="color" id="color-item" name="color" value={values.color} />
                                </Col>
                            </Row>
                            <Row gutter={11} justify="end" >
                                <Col>
                                    <SPButton
                                        title="Cancel"
                                        size="small"
                                        type="secondary"
                                        onButtonClick={() => {
                                            resetForm();
                                            closeDrawer();
                                        }}
                                    />
                                </Col>
                                <Col>
                                    <SPButton
                                        title={isCreate ? "Save" : "Update"}
                                        size="small"
                                        type="submit"
                                        onButtonClick={handleSubmit}
                                        isLoading={false}
                                    />
                                </Col>
                            </Row>
                        </Form>
                    )
                }}
            </Formik>
        </div>
    );
}

export default NonTechnicalFormDrawer;
