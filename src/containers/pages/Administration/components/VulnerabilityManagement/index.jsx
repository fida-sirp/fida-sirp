import React from 'react';
import AdministrationTab from '../AdministrationTab';
import Technical from './Components/Technical';
import NonTechnical from './Components/NonTechnical';

const VulnerabilityManagement = ({ access, parsedQuery, history }) => {
  const defaultSelectedSubTab =
    parsedQuery.active_sub_tab || 'technical_vulnerabilities';


    const tabsData = [];

    if(access!==undefined && (access.includes("all-super-admin") || access.includes("index-vulnerabilities-list"))){
        
      const technical_vulnerabilities =      {
        title: 'Technical Vulnerabilities',
        key: 'technical_vulnerabilities',
        component: <Technical access ={access} parsedQuery={parsedQuery} history={history} />,
      };
      tabsData.push(technical_vulnerabilities);
  }
  if(access!==undefined && (access.includes("all-super-admin") || access.includes("index-vulnerability-register"))){
        
    const non_technical_vulnerabilities =      {
      title: 'Non-Technical Vulnerabilities',
      key: 'non_technical_vulnerabilities',
      component: <NonTechnical access ={access} parsedQuery={parsedQuery} history={history} />,
    };
    tabsData.push(non_technical_vulnerabilities);
}


  const onClickHandler = data =>
    history.push(
      `/administration?active_tab=vulnerability_management&&active_sub_tab=${data?.key}`
    );

  return (
    <div>
      <AdministrationTab
        defaultSelectedSubTab={defaultSelectedSubTab}
        tabsData={tabsData}
        onTabClick={onClickHandler}
      />
    </div>
  );
};

export default VulnerabilityManagement;
